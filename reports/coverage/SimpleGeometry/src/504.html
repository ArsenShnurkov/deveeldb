<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>c:\dev\deveel\deveeldb\src\deveeldb-nunit\deveel.data.sql.statements\createviewstatementtests.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System;
using System.Collections.Generic;
using System.Linq;

using NUnit.Framework;

namespace Deveel.Data.Sql.Statements {
	[TestFixture]
	public class CreateViewStatementTests {
		[Test]
		public void ParseSimpleCreateView() {
			const string sql = &quot;CREATE VIEW text_view1 AS SELECT * FROM test_table WHERE a = 1&quot;;

			IEnumerable&lt;SqlStatement&gt; statements = null;
			Assert.DoesNotThrow(() =&gt; statements = SqlStatement.Parse(sql));
			Assert.IsNotNull(statements);

			var statementList = statements.ToList();
			Assert.IsNotEmpty(statementList);
			Assert.AreEqual(1, statementList.Count);
			Assert.IsInstanceOf&lt;CreateViewStatement&gt;(statementList[0]);

			var createView = (CreateViewStatement) statementList[0];
		}


		[Test]
		public void ParseCreateViewWithColumns() {
			const string sql = &quot;CREATE VIEW text_view1 (a, b, c) AS SELECT * FROM test_table WHERE a = 1&quot;;

			IEnumerable&lt;SqlStatement&gt; statements = null;
			Assert.DoesNotThrow(() =&gt; statements = SqlStatement.Parse(sql));
			Assert.IsNotNull(statements);

			var statementList = statements.ToList();
			Assert.IsNotEmpty(statementList);
			Assert.AreEqual(1, statementList.Count);
			Assert.IsInstanceOf&lt;CreateViewStatement&gt;(statementList[0]);

			var createView = (CreateViewStatement)statementList[0];
		}

		[Test]
		public void ParseCreateViewWithOrReplace() {
			const string sql = &quot;CREATE OR REPLACE VIEW text_view1 AS SELECT * FROM test_table WHERE a = 1&quot;;

			IEnumerable&lt;SqlStatement&gt; statements = null;
			Assert.DoesNotThrow(() =&gt; statements = SqlStatement.Parse(sql));
			Assert.IsNotNull(statements);

			var statementList = statements.ToList();
			Assert.IsNotEmpty(statementList);
			Assert.AreEqual(1, statementList.Count);
			Assert.IsInstanceOf&lt;CreateViewStatement&gt;(statementList[0]);

			var createView = (CreateViewStatement)statementList[0];
		}
	}
}

    </pre>
    <script type="text/javascript">
      highlightRanges([[14,4,14,48,1],[15,4,15,30,1],[15,66,15,68,1],[16,4,16,33,1],[18,4,18,44,1],[19,4,19,37,1],[20,4,20,44,1],[21,4,21,63,1],[23,4,23,60,1],[24,3,24,4,1],[31,4,31,48,1],[32,4,32,30,1],[32,66,32,68,1],[33,4,33,33,1],[35,4,35,44,1],[36,4,36,37,1],[37,4,37,44,1],[38,4,38,63,1],[40,4,40,59,1],[41,3,41,4,1],[47,4,47,48,1],[48,4,48,30,1],[48,66,48,68,1],[49,4,49,33,1],[51,4,51,44,1],[52,4,52,37,1],[53,4,53,44,1],[54,4,54,63,1],[56,4,56,59,1],[57,3,57,4,1],[15,30,15,66,1],[32,30,32,66,1],[48,30,48,66,1]]);
    </script>
  </body>
</html>