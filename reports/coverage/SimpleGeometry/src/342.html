<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>c:\dev\deveel\deveeldb\src\deveeldb\deveel.data.types\primitivetypes.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
// 
//  Copyright 2010-2015 Deveel
// 
//    Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
//    you may not use this file except in compliance with the License.
//    You may obtain a copy of the License at
// 
//        http://www.apache.org/licenses/LICENSE-2.0
// 
//    Unless required by applicable law or agreed to in writing, software
//    distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
//    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
//    See the License for the specific language governing permissions and
//    limitations under the License.
//

using System;
using System.Globalization;

using Deveel.Data.Spatial;

namespace Deveel.Data.Types {
	public static class PrimitiveTypes {
		public static BooleanType Boolean() {
			return Boolean(SqlTypeCode.Boolean);
		}

		public static BooleanType Boolean(SqlTypeCode sqlType) {
			return new BooleanType(sqlType);
		}

		public static BooleanType Bit() {
			return Boolean(SqlTypeCode.Bit);
		}

		public static StringType String(int maxSize) {
			return new StringType(SqlTypeCode.String, maxSize);
		}

		public static StringType String() {
			return String(SqlTypeCode.String);
		}

		public static StringType String(SqlTypeCode sqlType) {
			return String(sqlType, StringType.DefaultMaxSize);
		}

		public static StringType String(SqlTypeCode sqlType, int maxSize) {
			return new StringType(sqlType, maxSize);
		}

		public static StringType String(SqlTypeCode sqlType, CultureInfo locale) {
			return String(sqlType, StringType.DefaultMaxSize, locale);
		}

		public static StringType String(SqlTypeCode sqlType, int maxSize, CultureInfo locale) {
			return new StringType(sqlType, maxSize, locale);
		}

		public static NumericType Numeric() {
			return Numeric(-1);
		}

		public static NumericType Numeric(int size) {
			return Numeric(size, 0);
		}

		public static NumericType Numeric(int size, byte scale) {
			return Numeric(SqlTypeCode.Numeric, size, scale);
		}

		public static NumericType Numeric(SqlTypeCode sqlType) {
			return Numeric(sqlType, -1);
		}

		public static NumericType Numeric(SqlTypeCode sqlType, int size) {
			return Numeric(sqlType, size, 0);
		}

		public static NumericType Numeric(SqlTypeCode sqlType, int size, byte scale) {
			return new NumericType(sqlType, size, scale);
		}

		public static NumericType TinyInt(int size) {
			return Numeric(SqlTypeCode.TinyInt, size);
		}

		public static NumericType TinyInt() {
			return TinyInt(-1);
		}

		public static NumericType Integer() {
			return Integer(-1);
		}

		public static NumericType Integer(int size) {
			return Numeric(SqlTypeCode.Integer, size);
		}

		public static NullType Null() {
			return Null(SqlTypeCode.Null);
		}

		public static NullType Null(SqlTypeCode sqlType) {
			return new NullType(sqlType);
		}

		public static DateType Date() {
			return Date(SqlTypeCode.TimeStamp);
		}

		public static DateType Date(SqlTypeCode sqlType) {
			return new DateType(sqlType);
		}

		public static RowType RowType(ObjectName tableName) {
			return new RowType(tableName);
		}

		public static ColumnType ColumnType(ObjectName columnName) {
			return new ColumnType(columnName);
		}

		public static BinaryType Binary(int maxSize) {
			return Binary(SqlTypeCode.Binary, maxSize);
		}

		public static BinaryType Binary() {
			return Binary(SqlTypeCode.Binary);
		}

		public static BinaryType Binary(SqlTypeCode sqlType) {
			return Binary(sqlType, -1);
		}

		public static BinaryType Binary(SqlTypeCode sqlType, int maxSize) {
			return new BinaryType(sqlType, maxSize);
		}

		public static IntervalType Interval(SqlTypeCode sqlType) {
			return new IntervalType(sqlType);
		}

		public static bool IsPrimitive(SqlTypeCode sqlType) {
			if (sqlType == SqlTypeCode.Unknown ||
			    sqlType == SqlTypeCode.UserType ||
			    sqlType == SqlTypeCode.QueryPlan ||
			    sqlType == SqlTypeCode.Object)
				return false;

			return true;
		}

		public static bool IsPrimitive(string name) {
			if (System.String.IsNullOrEmpty(name))
				return false;

			if (name.EndsWith(&quot;%TYPE&quot;, StringComparison.InvariantCultureIgnoreCase) ||
				name.EndsWith(&quot;%ROWTYPE&quot;, StringComparison.InvariantCultureIgnoreCase))
				return true;

			// TODO: Support also the other SQL type names?
			if (name.Equals(&quot;NUMERIC&quot;, StringComparison.InvariantCultureIgnoreCase) ||
				name.Equals(&quot;STRING&quot;, StringComparison.InvariantCultureIgnoreCase) ||
				name.Equals(&quot;DATE&quot;, StringComparison.InvariantCultureIgnoreCase) ||
				name.Equals(&quot;NULL&quot;, StringComparison.InvariantCultureIgnoreCase) ||
				name.Equals(&quot;BOOLEAN&quot;, StringComparison.InvariantCultureIgnoreCase) ||
				name.Equals(&quot;BINARY&quot;, StringComparison.InvariantCultureIgnoreCase))
				return true;

			if (name.Equals(&quot;GEOMETRY&quot;, StringComparison.OrdinalIgnoreCase))
				return true;

			return false;
		}

		public static DataType Type(string typeName, params object[] args) {
			if (System.String.Equals(&quot;long varchar&quot;, typeName, StringComparison.OrdinalIgnoreCase))
				typeName = &quot;longvarchar&quot;;
			if (System.String.Equals(&quot;long varbinary&quot;, typeName, StringComparison.OrdinalIgnoreCase))
				typeName = &quot;longvarbinary&quot;;

			SqlTypeCode typeCode;

			try {
				typeCode = (SqlTypeCode) Enum.Parse(typeof (SqlTypeCode), typeName, true);
			} catch (Exception) {
				throw new ArgumentException(System.String.Format(&quot;The name {0} is not a valid SQL type.&quot;, typeName));
			}

			return Type(typeCode, args);
		}

		public static DataType Type(SqlTypeCode sqlType, params object[] args) {
			if (sqlType == SqlTypeCode.BigInt ||
				sqlType == SqlTypeCode.Boolean)
				return Boolean(sqlType);

			if (sqlType == SqlTypeCode.Numeric ||
				sqlType == SqlTypeCode.TinyInt ||
				sqlType == SqlTypeCode.SmallInt ||
				sqlType == SqlTypeCode.Integer ||
				sqlType == SqlTypeCode.BigInt ||
				sqlType == SqlTypeCode.Real ||
				sqlType == SqlTypeCode.Double ||
				sqlType == SqlTypeCode.Float ||
				sqlType == SqlTypeCode.Decimal) {
				if (args == null || args.Length == 0)
					return Numeric(sqlType);
				if (args.Length == 1)
					return Numeric(sqlType, (int)args[0]);
				if (args.Length == 2)
					return Numeric(sqlType, (int)args[0], (byte)args[1]);

				throw new ArgumentException(&quot;Invalid numer of arguments for NUMERIC type&quot;);
			}

			if (sqlType == SqlTypeCode.Char ||
				sqlType == SqlTypeCode.VarChar ||
				sqlType == SqlTypeCode.LongVarChar ||
				sqlType == SqlTypeCode.String ||
				sqlType == SqlTypeCode.Clob) {
				if (args == null || args.Length == 0)
					return String(sqlType);
				if (args.Length == 1) {
					var arg = args[0];
					if (arg is int)
						return String(sqlType, (int) arg);
					if (arg is string)
						return String(sqlType, CultureInfo.GetCultureInfo((string) arg));
				} else if (args.Length == 2) {
					var arg1 = (int)args[0];
					var arg2 = (string)args[1];
					return new StringType(sqlType, arg1, CultureInfo.GetCultureInfo(arg2));
				}

				throw new ArgumentException(&quot;Invalid numer of arguments for STRING type&quot;);
			}

			if (sqlType == SqlTypeCode.Binary ||
				sqlType == SqlTypeCode.VarBinary ||
				sqlType == SqlTypeCode.LongVarBinary ||
				sqlType == SqlTypeCode.Blob) {
				if (args == null || args.Length == 0)
					return Binary(sqlType);
				if (args.Length == 1)
					return Binary(sqlType, (int)args[0]);

				throw new ArgumentException(&quot;Invalid number of arguments for BINARY type&quot;);
			}

			if (sqlType == SqlTypeCode.Date ||
				sqlType == SqlTypeCode.Time ||
				sqlType == SqlTypeCode.TimeStamp)
				return Date(sqlType);

			if (sqlType == SqlTypeCode.Null)
				return Null(sqlType);

			if (sqlType == SqlTypeCode.RowType) {
				if (args == null || args.Length != 1)
					throw new ArgumentException(&quot;Invalid number of arguments for %ROWTYPE type&quot;);

				return RowType((ObjectName)args[0]);
			}

			if (sqlType == SqlTypeCode.ColumnType) {
				if (args == null || args.Length != 1)
					throw new ArgumentException(&quot;Invalid number of arguments for %TYPE type&quot;);

				return ColumnType((ObjectName)args[0]);
			}

			if (sqlType == SqlTypeCode.Geometry) {
				if (args == null || args.Length == 0)
					return new GeometryType();

				var srid = (int) args[0];
				return new GeometryType(srid);
			}

			throw new ArgumentException(System.String.Format(&quot;The SQL type {0} is not primitive.&quot;, sqlType));
		}

		public static DataType FromType(Type type) {
			if (type == typeof(bool))
				return Boolean();
			if (type == typeof(string))
				return String();
			if (type == typeof (byte))
				return Bit();
			if (type == typeof (short))
				return TinyInt();

			throw new NotSupportedException();
		}
	}
}
    </pre>
    <script type="text/javascript">
      highlightRanges([[37,4,37,55,0],[53,4,53,62,0],[117,4,117,34,0],[121,4,121,38,0],[125,4,125,47,0],[141,4,141,37,0],[145,4,148,38,0],[149,5,149,18,0],[151,4,151,16,0],[155,4,155,42,0],[156,5,156,18,0],[158,4,159,76,0],[160,5,160,17,0],[163,4,168,72,0],[169,5,169,17,0],[171,4,171,68,0],[172,5,172,17,0],[174,4,174,17,0],[178,4,178,91,0],[179,5,179,30,0],[180,4,180,93,0],[181,5,181,32,0],[186,5,186,79,0],[187,6,187,23,0],[188,5,188,106,0],[191,4,191,32,0],[197,5,197,29,0],[210,5,210,26,0],[211,6,211,44,0],[212,5,212,26,0],[213,6,213,59,0],[215,5,215,80,0],[229,6,229,24,0],[230,7,230,72,0],[237,5,237,79,0],[244,5,244,42,0],[245,6,245,29,0],[246,5,246,26,0],[247,6,247,43,0],[249,5,249,80,0],[257,4,257,36,0],[258,5,258,26,0],[260,4,260,39,0],[261,5,261,42,0],[262,6,262,83,0],[264,5,264,41,0],[267,4,267,42,0],[268,5,268,42,0],[269,6,269,80,0],[271,5,271,44,0],[274,4,274,40,0],[275,5,275,42,0],[276,6,276,32,0],[278,5,278,30,0],[279,5,279,35,0],[282,4,282,101,0],[286,4,286,29,0],[287,5,287,22,0],[288,4,288,31,0],[289,5,289,21,0],[290,4,290,30,0],[291,5,291,18,0],[292,4,292,31,0],[293,5,293,22,0],[295,4,295,38,0],[25,4,25,40,1],[29,4,29,36,1],[33,4,33,36,1],[41,4,41,38,1],[45,4,45,54,1],[49,4,49,44,1],[57,4,57,52,1],[61,4,61,23,1],[65,4,65,28,1],[69,4,69,53,1],[73,4,73,32,1],[77,4,77,37,1],[81,4,81,49,1],[85,4,85,46,1],[89,4,89,23,1],[93,4,93,23,1],[97,4,97,46,1],[101,4,101,34,1],[105,4,105,33,1],[109,4,109,39,1],[113,4,113,33,1],[129,4,129,38,1],[133,4,133,31,1],[137,4,137,44,1],[195,4,196,36,1],[199,4,207,36,1],[208,5,208,42,1],[209,6,209,30,1],[218,4,222,33,1],[223,5,223,42,1],[224,6,224,29,1],[225,5,225,26,1],[226,6,226,24,1],[227,6,227,21,1],[228,7,228,41,1],[231,12,231,33,1],[232,6,232,30,1],[233,6,233,33,1],[234,6,234,77,1],[240,4,243,33,1],[252,4,254,38,1],[255,5,255,26,1]]);
    </script>
  </body>
</html>