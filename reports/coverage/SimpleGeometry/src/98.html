<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>c:\dev\deveel\deveeldb\src\deveeldb\deveel.data.index\indexrange.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
// 
//  Copyright 2010-2015 Deveel
// 
//    Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
//    you may not use this file except in compliance with the License.
//    You may obtain a copy of the License at
// 
//        http://www.apache.org/licenses/LICENSE-2.0
// 
//    Unless required by applicable law or agreed to in writing, software
//    distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
//    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
//    See the License for the specific language governing permissions and
//    limitations under the License.
//

using System;
using System.Text;

using Deveel.Data.Sql.Objects;
using Deveel.Data.Types;

namespace Deveel.Data.Index {
	/// &lt;summary&gt;
	/// Describes the range of values to select from an index.
	/// &lt;/summary&gt;
	/// &lt;remarks&gt;
	/// A range has a start value, an end value, and whether we should pick 
	/// inclusive or exclusive of the end value. The start value may be a 
	/// concrete value from the set or it may be a flag that represents the 
	/// start or end of the list.
	/// &lt;para&gt;
	/// Note that the the start value may not compare less than the end value.
	/// For example, start can not be &lt;see cref=&quot;RangeFieldOffset.LastValue&quot;/&gt; 
	/// and end can not be  &lt;see cref=&quot;RangeFieldOffset.FirstValue&quot;/&gt;.
	/// &lt;/para&gt;
	/// &lt;/remarks&gt;
	public struct IndexRange {
		/// &lt;summary&gt;
		/// 
		/// &lt;/summary&gt;
		public static readonly DataObject FirstInSet = new DataObject(PrimitiveTypes.Null(), new SqlString(&quot;FirstInSet&quot;));

		/// &lt;summary&gt;
		/// 
		/// &lt;/summary&gt;
		public static readonly DataObject LastInSet = new DataObject(PrimitiveTypes.Null(), new SqlString(&quot;LastInSet&quot;));

		/// &lt;summary&gt;
		/// Constructs the range given a start and an end location
		/// &lt;/summary&gt;
		/// &lt;param name=&quot;startOffset&quot;&gt;The offset of the first value of the range.&lt;/param&gt;
		/// &lt;param name=&quot;firstValue&quot;&gt;The first value of the range&lt;/param&gt;
		/// &lt;param name=&quot;lastOffset&quot;&gt;The offset within the range of the last value.&lt;/param&gt;
		/// &lt;param name=&quot;endValue&quot;&gt;The last value of the range.&lt;/param&gt;
		public IndexRange(RangeFieldOffset startOffset, DataObject firstValue, RangeFieldOffset lastOffset, DataObject endValue)
			: this(false) {
			StartOffset = startOffset;
			StartValue = firstValue;
			EndOffset = lastOffset;
			EndValue = endValue;
		}

		private IndexRange(bool isNull)
			: this() {
			IsNull = isNull;
		}

		public bool IsNull { get; private set; }

		/// &lt;summary&gt;
		/// The entire range of values in an index (including &lt;c&gt;NULL&lt;/c&gt;)
		/// &lt;/summary&gt;
		public static readonly IndexRange FullRange = new IndexRange(RangeFieldOffset.FirstValue, FirstInSet,
			RangeFieldOffset.LastValue, LastInSet);

		/// &lt;summary&gt;
		/// The entire range of values in an index (not including &lt;c&gt;NULL&lt;/c&gt;)
		/// &lt;/summary&gt;
		public static readonly IndexRange FullRangeNotNull = new IndexRange(RangeFieldOffset.AfterLastValue, DataObject.Null(),
			RangeFieldOffset.LastValue, LastInSet);

		public static readonly IndexRange Null = new IndexRange(true);

		/// &lt;summary&gt;
		/// Gets the offset of the first value of the range.
		/// &lt;/summary&gt;
		public RangeFieldOffset StartOffset { get; private set; }

		/// &lt;summary&gt;
		/// Gets the first value of the range.
		/// &lt;/summary&gt;
		public DataObject StartValue { get; private set; }

		/// &lt;summary&gt;
		/// Gets the offset of the last value of the range.
		/// &lt;/summary&gt;
		public RangeFieldOffset EndOffset { get; private set; }

		/// &lt;summary&gt;
		/// Gets the last value of the range.
		/// &lt;/summary&gt;
		public DataObject EndValue { get; private set; }

		/// &lt;inheritdoc/&gt;
		public override bool Equals(object obj) {
			var destRange = (IndexRange)obj;
			if (IsNull &amp;&amp; destRange.IsNull)
				return true;
			if (IsNull &amp;&amp; !destRange.IsNull)
				return false;
			if (!IsNull &amp;&amp; destRange.IsNull)
				return false;

			return (StartValue.Value.Equals(destRange.StartValue.Value) &amp;&amp;
			        EndValue.Value.Equals(destRange.EndValue.Value) &amp;&amp;
			        StartOffset == destRange.StartOffset &amp;&amp;
			        EndOffset == destRange.EndOffset);
		}

		/// &lt;inheritdoc/&gt;
		public override int GetHashCode() {
			return base.GetHashCode();
		}

		/// &lt;inheritdoc/&gt;
		public override string ToString() {
			var sb = new StringBuilder();
			if (StartOffset == RangeFieldOffset.FirstValue) {
				sb.Append(&quot;FIRST_VALUE &quot;);
			} else if (StartOffset == RangeFieldOffset.AfterLastValue) {
				sb.Append(&quot;AFTER_LAST_VALUE &quot;);
			}

			sb.Append(StartValue.ToString());
			sb.Append(&quot; -&gt; &quot;);
			if (EndOffset == RangeFieldOffset.LastValue) {
				sb.Append(&quot;LAST_VALUE &quot;);
			} else if (EndOffset == RangeFieldOffset.BeforeFirstValue) {
				sb.Append(&quot;BEFORE_FIRST_VALUE &quot;);
			}
			sb.Append(EndValue.ToString());
			return sb.ToString();
		}

		public static bool operator ==(IndexRange a, IndexRange b) {
			return a.Equals(b);
		}

		public static bool operator !=(IndexRange a, IndexRange b) {
			return !(a == b);
		}
	}
}
    </pre>
    <script type="text/javascript">
      highlightRanges([[107,4,107,36,0],[108,4,108,35,0],[109,5,109,17,0],[110,4,110,36,0],[111,5,111,18,0],[112,4,112,36,0],[113,5,113,18,0],[115,4,118,46,0],[123,4,123,30,0],[128,4,128,33,0],[129,4,129,51,0],[130,5,130,31,0],[131,11,131,62,0],[132,5,132,36,0],[135,4,135,37,0],[136,4,136,22,0],[137,4,137,48,0],[138,5,138,30,0],[139,11,139,62,0],[140,5,140,38,0],[142,4,142,35,0],[143,4,143,25,0],[147,4,147,23,0],[151,4,151,21,0],[56,3,57,17,1],[58,4,58,30,1],[59,4,59,28,1],[60,4,60,27,1],[61,4,61,24,1],[62,3,62,4,1],[65,6,65,12,1],[66,4,66,20,1],[67,3,67,4,1],[42,3,42,117,1],[47,3,47,115,1],[74,3,75,43,1],[80,3,81,43,1],[83,3,83,65,1]]);
    </script>
  </body>
</html>